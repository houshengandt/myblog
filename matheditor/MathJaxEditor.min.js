!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.MathJaxEditor=t():e.MathJaxEditor=t()}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i(1),a=i(7),o=i(5),l=o.repeat;window.addEventListener("load",a);var u=function(){function e(t){n(this,e);var i=new s(t);this.core=i,this.version="1.3.9"}return r(e,[{key:"blur",value:function(){this.core.blur()}},{key:"focus",value:function(){this.core.focus()}},{key:"insertCommand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.core.insertCommand(e,t,i)}},{key:"insert",value:function(e){this.core.insert(e)}},{key:"insertSymbol",value:function(e){this.core.insertSymbol(e)}},{key:"getValue",value:function(){return this.core.value}},{key:"setValue",value:function(e){this.core.setValue(e,!0)}},{key:"moveCursorLeft",value:function(){this.core.moveCursorLeft()}},{key:"moveCursorRight",value:function(){this.core.moveCursorRight()}},{key:"insertMatrix",value:function(e,t){for(var i=l("&",e-1),n=t-1,r="\\begin{bmatrix}"+i,s=0;s<n;s++)r+="\\\\"+i;r+="\\end{bmatrix}",this.core.insert(r)}},{key:"erase",value:function(){this.core.erase()}},{key:"on",value:function(e,t){this.core.on(e,t)}}]),e}();e.exports=u},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i(2),a=i(3),o=i(4),l=i(6),u=i(5),c=u.addClass,h=u.insertBetween,d=u.inArray,f=u.mustFindElement,p=u.removeClass,m=u.removeFragment,v=u.repeat,y=l.supOrSub,x=8,b=13,g=37,k=39,C=46,E=function(){function e(t){var i=this;n(this,e);var r=t.el,a=t.debug,l=void 0!==a&&a,u=t.focusClass,c=void 0===u?"isFocused":u,h=t.newLine,d=void 0!==h&&h,p=t.value,m=void 0===p?"":p,v=t.scroll,y=void 0!==v&&v,x=MathJax.HTML.Element,b=f(r,"textarea"),g=x("div",{className:"Mathjax_Editor"}),k=x("input",{className:"Mathjax_EditorInput"}),C=x("div",{className:"Mathjax_EditorDisplay"},["\\({\\cursor}"+m+"\\)"]),E=x("pre",{className:"Mathjax_EditorDebug"},["|"]),w=x("div",{className:"Mathjax_EditorCursor"});b.parentNode.insertBefore(g,b.nextSibling),g.appendChild(k),g.appendChild(C),g.appendChild(E),g.appendChild(w),k.addEventListener("keydown",this.handleInputEvent.bind(this)),k.addEventListener("keyup",this.handleInputEvent.bind(this)),k.addEventListener("blur",this.blur.bind(this)),C.addEventListener("click",this.focus.bind(this)),C.addEventListener("mouseenter",this.handleMouseEnter.bind(this)),C.addEventListener("mouseleave",this.handleMouseLeave.bind(this)),document.body.addEventListener("click",this.handleBodyClick.bind(this)),C.style.opacity=0,C.style.overflowX=y?"scroll":"hidden",E.style.display=l?"block":"none",b.style.display="none",MathJax.Hub.Queue(function(){return MathJax.Hub.Typeset(C)},function(){return i.jaxElement=MathJax.Hub.getAllJax(C)[0]},function(){C.style.opacity=1,C.style.minHeight=C.offsetHeight+"px",i.update({cursorHidden:!0})}),this.$container=g,this.$cursor=w,this.$debug=E,this.$display=C,this.$input=k,this.$el=b,this.bus=new s,this.cursorIndex=0,this.lastCursorTimeout=null,this.placer=null,this.debug=l,this.focusClass=c,this.newLine=d,this.tex=new o(m,0),this.value=m,this.mouseAtDisplay=!1,this.textAlignment="left",this.getDisplayAlignment()}return r(e,[{key:"update",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this.cursorIndex,n=this.value,r=new o(n,i);this.tex=r,this.debug&&(this.$debug.innerHTML=h(n,i,"|")),this.updateJaxElement(r.displayTex,function(){setTimeout(function(){var t=new a(e);t.on("setCursor",function(t){e.debug&&console.info("The cursor should be placed at "+t+"."),e.cursorIndex=t,e.update()}),e.placer=t},16),e.updateCursorElement(t)})}},{key:"updateJaxElement",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Function;MathJax.Hub.Queue(function(){return t.jaxElement.Text(e)},i)}},{key:"updateCursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.cursorIndex,i=this.tex.cursorPoints,n=i.indexOf(t),r=t;e>0?r=i[n+1]:e<0&&(r=i[n-1]),this.cursorIndex=r,this.update()}},{key:"updateCursorElement",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this.$display,n=this.$cursor,r=t.cursorHidden||!1,s="wasRecentlyPlaced";n&&(n.style.display=r?"none":"inline-block",this.lastCursorTimeout&&clearTimeout(this.lastCursorTimeout),c(n,s),this.lastCursorTimeout=setTimeout(function(){return p(n,s)},400),MathJax.Hub.Queue(function(){var t=i.querySelector(".mjx-cursor");if(t){var r=t.getBoundingClientRect(),s=r.left,a=r.right,o=r.top,l=r.bottom,u=s;switch(e.textAlignment){case"center":u=s+(a-s)/2;break;case"right":u=a}n.style.left=u+"px",n.style.top=o+"px",n.style.height=l-o+"px",i.scrollLeft=s,t.parentNode.removeChild(t)}}))}},{key:"getDisplayAlignment",value:function(){var e=window.getComputedStyle(this.$display);this.textAlignment=e.getPropertyValue("text-align")||"left"}},{key:"setValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.value=e,t&&(this.cursorIndex=0),this.$el.innerHTML=e,this.update(),this.bus.trigger("change")}},{key:"handleInputEvent",value:function(e){var t=this,i=this.$input,n=l.number,r=l.variable,s=l.charToCommand,a=l.operators,o=l.escapedOperators,u=i.value.trim(),c=e.keyCode;return i.value="","keyup"===e.type&&(c=null),u.length?void u.split("").forEach(function(e){return e.match(n)||e.match(r)?t.insert(e):s.hasOwnProperty(e)?t.insertCommand(s[e]):d(e,a.concat(o))?t.insertSymbol(e):void 0}):this.handleKeyPress(c)}},{key:"handleKeyPress",value:function(e){switch(e){case g:return void this.moveCursorLeft();case k:return void this.moveCursorRight();case x:return void this.erase();case C:return void this.delete();case b:return void(this.newLine&&this.insert("\\\\"))}e&&this.debug&&console.warn("The key "+e+" was pressed.")}},{key:"moveCursorLeft",value:function(){this.cursorIndex>0&&this.updateCursor(-1)}},{key:"moveCursorRight",value:function(){this.cursorIndex<this.value.length&&this.updateCursor(1)}},{key:"handleBodyClick",value:function(e){this.placer&&this.placer.trigger("click",e)}},{key:"focus",value:function(){this.$input.focus(),this.updateCursorElement({cursorHidden:!1}),this.bus.trigger("focus"),c(this.$display,this.focusClass)}},{key:"blur",value:function(){this.mouseAtDisplay||(this.$input.blur(),this.updateCursorElement({cursorHidden:!0}),this.bus.trigger("blur"),p(this.$display,this.focusClass))}},{key:"handleMouseEnter",value:function(){this.mouseAtDisplay=!0}},{key:"handleMouseLeave",value:function(){this.mouseAtDisplay=!1}},{key:"insert",value:function(e){var t=this.cursorIndex,i=this.value;this.cursorIndex+=e.length,this.setValue(h(i,t,e)),this.update()}},{key:"insertChar",value:function(e){var t=l.number,i=l.variable;if(1!==e.length)throw new RangeError("Only one char can be inserted through this method.");if(!e.match(t)&&!e.match(i))throw new RangeError('Only numbers and variables are allowed in insert, not "'+e+'".');this.insert(e)}},{key:"insertSymbol",value:function(e){var t=l.operators,i=l.escapedOperators,n=t.slice().concat(i);if(!d(e,n))throw new RangeError('"'+e+'" is not a valid symbol.');d(e,i)&&(e="\\"+e),this.insert(e)}},{key:"insertCommand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.focus(),"\\"===e[0]||d(e,y)||(e="\\"+e),i&&(e+="[]"),e+=t>0?"{":" ",this.insert(e),!(t<1)){var n=this.value,r=this.cursorIndex,s="}"+v("{}",t-1);this.setValue(h(n,r,s)),this.update()}}},{key:"applyDeletion",value:function(e){var t=this.cursorIndex,i=this.tex,n=t-1,r=i.elements,s=null,a=null,o=void 0,l=void 0,u=void 0,c=void 0,h=void 0;switch(e){case"erase":if(0===t)return;o=n,l="end",u="openIndex",c=n,h=t;break;case"delete":if(t===i.length)return;o=t,l="start",u="closeIndex",c=t,h=t+1;break;default:throw new RangeError('Unknown method "'+e+'".')}if(i.newLines[o]){var d=i.newLines[o];s=d.start,a=d.end+1}else{var f=!0,p=!1,v=void 0;try{for(var y,x=r[Symbol.iterator]();!(f=(y=x.next()).done);f=!0){var b=y.value,g=b.index,k=b.props;if(k){var C=k.brackets;if(k[l]===o||C&&C[u]===o){s=k.start,a=k.end+1;break}if(!k.blocks)continue;var E=!0,w=!1,T=void 0;try{for(var I,j=k.blocks[Symbol.iterator]();!(E=(I=j.next()).done);E=!0){var S=I.value;if(S[u]===o){s=k.start,a=k.end+1;break}}}catch(e){w=!0,T=e}finally{try{!E&&j.return&&j.return()}finally{if(w)throw T}}}else if(g===o){s=c,a=h;break}}}catch(e){p=!0,v=e}finally{try{!f&&x.return&&x.return()}finally{if(p)throw v}}}this.cursorIndex=s,this.setValue(m(this.value,s,a)),this.update()}},{key:"erase",value:function(){this.applyDeletion("erase")}},{key:"delete",value:function(){this.applyDeletion("delete")}},{key:"on",value:function(e,t){this.bus.on(e,t)}}]),e}();e.exports=E},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(){function e(){i(this,e),this.registry={}}return n(e,[{key:"on",value:function(e,t){this.registry[e]=(this.registry[e]||[]).concat(t)}},{key:"trigger",value:function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.registry[e]&&this.registry[e].forEach(function(e){return e.apply(void 0,i)})}}]),e}();e.exports=r},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(2),o=[],l=function(){function e(t){n(this,e);var i=new a;i.on("click",this.handleClick.bind(this)),this.$display=t.$display,this.bus=i,this.intervals=[],this.elements=t.tex.elements,this.findings={},this.tex=t.tex,this.iterate()}return s(e,[{key:"on",value:function(e,t){this.bus.on(e,t)}},{key:"trigger",value:function(e){for(var t,i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];(t=this.bus).trigger.apply(t,[e].concat(n))}},{key:"handleClick",value:function(e){var t=this,i=this.$display.getBoundingClientRect(),n=i.top,s=i.bottom,a=e.clientX,o=e.clientY,l=this.intervals,u=this.tex.length;if(!l.length||o>s||o<n)return!1;var c=!1,h=!0;if(l.forEach(function(e,i){e.startX<=a&&a<e.endX&&h&&e.startY<=o&&o<e.endY&&(c=!0,u=t.placeAtInterval(e,i,a),e.box&&(h=!1))}),!c){var d=function(){var e={interval:null,distance:null,i:null};return l.forEach(function(t,i){if(t.startY<o&&o<t.endY){var n=Math.min(Math.abs(t.startX-a),Math.abs(t.endX-a));(null===e.distance||n<e.distance)&&(e.interval=t,e.distance=n,e.i=i)}}),e.interval?void(u=t.placeAtInterval(e.interval,e.i,a,o)):{v:!1}}();if("object"===("undefined"==typeof d?"undefined":r(d)))return d.v}this.bus.trigger("setCursor",u)}},{key:"getNextKeyFor",value:function(e){this.findings[e]=this.findings[e]||0;var t=this.findings[e];return this.findings[e]+=1,t}},{key:"addIntervalAt",value:function(e,t){this.intervals.splice(e,0,t)}},{key:"addInterval",value:function(e){Number.isNaN(e.index)&&console.error("An interval has NaN as index."),this.intervals.push(e)}},{key:"addIntervalBox",value:function(e,t){var i=t.top,n=t.bottom,r=t.left,s=t.right;this.addInterval({index:e,startX:r,endX:s,startY:i,endY:n,box:!0})}},{key:"addBouncinglessInterval",value:function(e){this.addInterval({index:e,top:0,bottom:0,left:0,right:0})}},{key:"placeAtInterval",value:function(e,t,i){var n=this.intervals,r=e.endX-e.startX,s=t+1,a=e.index;return e.box?a:(i>e.startX+r/2&&(a=n[s]?n[s].index:this.tex.length),a)}},{key:"iterate",value:function(){var e=this;this.elements.forEach(function(t){switch(t.is){case"command":e.findCommand(t);break;case"eol":e.findEndOfLine(t);break;case"begin":e.findBegin(t);break;case"end":break;case"skip":e.skip(t);break;default:e.find(t)}})}},{key:"find",value:function(e){var t=e.type,i=e.index,n=e.nearClosure,r=this.getNextKeyFor(t),s=this.$display.querySelectorAll(".mjx-"+t)[r];if(!s)return console.warn("Could not find an element of type "+t+".",i);var a=s.getBoundingClientRect(),o=a.left,l=a.right,u=a.top,c=a.bottom;this.addInterval({startX:o,endX:l,startY:u,endY:c,index:i}),n&&this.addBouncinglessInterval(i+1)}},{key:"findCommand",value:function(e){var t=this,i=e.type,n=e.props,r=this.getNextKeyFor(i),s=this.$display.querySelectorAll(".mjx-m"+i)[r],a=n.brackets,o=n.blocks,l=n.subType;switch(this.addBouncinglessInterval(n.start),i){case"frac":var u=s.querySelector(".mjx-numerator"),c=s.querySelector(".mjx-denominator"),h=u.getBoundingClientRect(),d=c.getBoundingClientRect(),f=[h,d];f.forEach(function(e,i){1===o[i].length&&t.addIntervalBox(o[i].closeIndex,e)});break;case"root":case"sqrt":if(a&&a.closeIndex-a.openIndex===1){var p=s.querySelector(".mjx-root .mjx-char"),m=p.getBoundingClientRect();this.addIntervalBox(a.closeIndex,m)}if(1===o[0].length){var v=s.querySelector(".mjx-box"),y=v.getBoundingClientRect();this.addIntervalBox(o[0].closeIndex,y)}break;case"subsup":if(1===o[0].length){var x=s.querySelector(".mjx-"+l),b=x.getBoundingClientRect();this.addIntervalBox(o[0].closeIndex,b)}}}},{key:"findEndOfLine",value:function(e){var t=e.type,i=e.index,n=this.getNextKeyFor(t),r=this.$display.querySelectorAll(".mjx-"+t)[n];r||(r=this.$display.querySelector(".mjx-math"));var s=r.firstChild,a=s.getBoundingClientRect(),o=a.top,l=a.left,u=a.bottom,c=a.right,h=20,d=this.findLastStartOfLineIndex();this.addIntervalAt(d.intervalKey,{index:d.start,startX:l-h,endX:l,startY:o,endY:u,box:!0}),this.addInterval({index:i,startX:c,endX:c+h,startY:o,endY:u,box:!0})}},{key:"findBegin",value:function(e){var t=this,i=e.type,n=e.props,r=this.getNextKeyFor(i),s=this.$display.querySelectorAll(".mjx-mtable")[r],a=s.querySelectorAll(".mjx-isEmpty"),o=0;n.cells.forEach(function(e){var i=e.end-e.start;if(0===i||1===i){var n=a[o++],r=n.getBoundingClientRect();t.addIntervalBox(e.start,r)}})}},{key:"skip",value:function(e){var t=e.type;this.getNextKeyFor(t)}},{key:"findLastStartOfLineIndex",value:function(){for(var e=this.intervals.slice().reverse(),t=e.length,i=0,n=0,r=0;i<t;i++){var s=e[i];if("eol"===s.is){n=s.index+2,r=i;break}}return{start:n,intervalKey:r}}},{key:"paint",value:function(e){var t=document.createElement("div");return t.style.position="absolute",t.style.backgroundColor="rgba(0, 0, 255, 0.5)",t.style.width=e.endX-e.startX+"px",t.style.height=e.endY-e.startY+"px",t.style.top=e.startY+"px",t.style.left=e.startX+"px",t.style.pointerEvents="none",document.body.appendChild(t),t}},{key:"paintIntervals",value:function(){var e=this;o.forEach(function(e){return document.body.removeChild(e)}),o=[],this.intervals.forEach(function(t){o.push(e.paint(t))}),console.log(this.intervals)}}]),e}();e.exports=l},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=i(5),a=s.inArray,o=s.listToCharacterRegex,l=i(6),u=l.nearClosureHaystack,c=l.supOrSub,h=l.cursorTex,d=l.emptyTex,f=l.escType,p=l.spacingTex,m=l.relationCommands,v={isNumber:l.number,isVariable:l.variable,isOperator:o(l.operators),isEscapedOperator:o(l.escapedOperators)},y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n(this,e),this.tex=t,this.cursorPoints=[],this.elements=[],this.newLines={},this.length=t.length,this.displayTex="",this.cursorIndex=i,this.isPartOfCommand={},this.parse()}return r(e,[{key:"addCursorToTexDisplay",value:function(e){this.cursorPlaced||this.cursorIndex!==e&&0!==this.length&&e!==this.length||(this.cursorPlaced=!0,this.displayTex+=h)}},{key:"parse",value:function(){var e=[],t=this.tex,i=this.tex.length,n=0,r=!1,s=null;for(this.cursorPlaced=!1;n<i;n++){var o=n,l=n+1,h=t[o],m=t[l],y=t[o-1],x=a(m,u),b=","===h,g=a(h,["<",">"]),k=v.isNumber.exec(h),C=v.isVariable.exec(h),E=v.isOperator.exec(h),w=v.isEscapedOperator.exec(m),T="\\"===h&&this.isRelationCommand(o),I=b||k||g;if(this.addCursorToTexDisplay(o),(I||T)&&(this.displayTex+="{"),"}"===h&&"\\"!==y&&(this.isPartOfCommandThatStartsWith(o,c)||(this.displayTex+=p)),this.displayTex+=h,I&&(this.displayTex+="}"),k&&this.elements.push({is:"number",type:"mn",index:o,nearClosure:x}),C&&this.elements.push({is:"variable",type:"mi",index:o,nearClosure:x}),E&&!this.isPartOfCommand.hasOwnProperty(o)&&this.elements.push({is:"operator",type:"mo",index:o,nearClosure:x}),"\\"===h&&w){var j=f[m]?f[m]:"mo";this.elements.push({is:"operator",type:j,index:o,nearClosure:x,props:{start:o,end:l}}),this.displayTex+=m,n+=1}if("\\"===h&&"\\"===m){if(!r){var S={start:o,end:l};this.newLines[o]=S,this.newLines[l]=S,this.elements.push({is:"eol",type:"block",index:o})}this.displayTex+="\\",n+=1,r&&"&"===t[n+1]&&(this.displayTex+=d)}if("\\"===h&&v.isVariable.exec(m)){var M=this.parseCommand(n),A=M.continueIterationAt,O=M.element;switch(O.is){case"begin":r=!0,s=O,this.findAhead(O.props.end,"}&")&&(this.displayTex+=d);break;case"end":r=!1,this.parseBegin(s,O),s=null}n=A}a(h,c)&&(n=this.parseCommand(n).continueIterationAt),"{"!==h?" "!==h&&("&"===h&&(this.findAhead(n+1,"\\end")||"&"===m||this.findAhead(n+1,"\\\\"))&&(this.displayTex+=d),e.push(o)):"}"===m?(this.addCursorToTexDisplay(l),this.displayTex+=d):this.isPartOfCommandThatStartsWith(o,c)||r||(this.displayTex+=p)}i&&this.elements.push({is:"eol",type:"block",index:i}),this.addCursorToTexDisplay(i),e.push(i),this.cursorPoints=e}},{key:"parseCommand",value:function(e){var t=e,i=this.tex,n=this.tex.length,r=i[t],s={firstChar:r},o=null,l=[],h=null,f=0,y="",x=null,b="command",g=t,k=null,C=!1,E=null,w="";switch(r){case"^":y="subsup",x="sup";break;case"_":y="subsup",x="sub"}for(e=t;e<n;e++){var T=i[e],I=e+1,j=i[I],S=v.isVariable.exec(T);if(null===o&&(this.displayTex+=a(T,["\\","^","_"])?"":T,S&&(y+=T)),"["===T&&(h={openIndex:e},null===o&&(o=e,E=o),"]"===j&&(this.displayTex+=d)),"]"===T&&(h.closeIndex=e,this.isPartOfCommand[e]=s),"{"===T?(0===f&&(l.push({openIndex:e}),this.isPartOfCommand[e]=s),null===o&&(o=e,E=o,a(r,c)||a(y,["begin","end"])||(this.displayTex+=p),this.addCursorToTexDisplay(I),"}"===j&&(this.displayTex+=d)),f+=1):f>0&&"}"!==T&&(w+=T),"}"===T&&(f-=1,0===f)){var M=l.length-1;l[M].closeIndex=e,l[M].contents=w,l[M].length=e-l[M].openIndex,w="",this.isPartOfCommand[e]=s}if(null===o&&" "===T){var A=a(y,m);y=this.decideType(y),b="mo"===y?"operator":"variable",k=e,o=e,E=o,a(j,u)&&(C=!0),A&&(this.displayTex+="}");break}if("}"===T&&"{"!==j&&0===f){k=e;break}}if("sqrt"===y&&null!==h&&(y="root"),null===o)throw new SyntaxError("Looks like this TeX is invalid. Now have a hard time finding where, lul.");if(a(y,["begin","end"])&&(b=y,y=l[0].contents,E=k,this.displayTex+=y+"}","end"===y))return{continueIterationAt:E,element:{is:"end"}};var O={is:b,type:y,index:t,nearClosure:C,props:{subType:x,start:g,end:k,opening:o,blocks:l,brackets:h}};return"begin"===b&&this.elements.push({is:"skip",type:"mo"}),this.elements.push(O),"end"===b&&this.elements.push({is:"skip",type:"mo"}),{continueIterationAt:E,element:O}}},{key:"decideType",value:function(e){var t={alpha:"mi",beta:"mi",gamma:"mi",Gamma:"mi",delta:"mi",Delta:"mi",epsilon:"mi",varepsilon:"mi",zeta:"mi",eta:"mi",theta:"mi",vartheta:"mi",Theta:"mi",iota:"mi",kappa:"mi",lambda:"mi",mu:"mi",nu:"mi",xi:"mi",Xi:"mi",pi:"mi",Pi:"mi",rho:"mi",varrho:"mi",sigma:"mi",Sigma:"mi",tau:"mi",upsilon:"mi",Upsilon:"mi",phi:"mi",varphi:"mi",Phi:"mi",chi:"mi",psi:"mi",Psi:"mi",omega:"mi",Omega:"mi","%":"mi"};return t.hasOwnProperty(e)?t[e]:"mo"}},{key:"isPartOfCommandThatStartsWith",value:function(e,t){var i=this.isPartOfCommand[e];return!!i&&a(i.firstChar,t)}},{key:"isRelationCommand",value:function(e){var t=this.tex,i=t.length;if("\\"===t[e]){for(var n=e+1,r="";n<i;n++){var s=t[n];if(!v.isVariable.exec(s)&&" "!==s)return!1;if(" "===s)return a(r,m);r+=s}return!1}}},{key:"parseBegin",value:function(e,t){for(var i=this.tex,n=t.index+1,r=[],s=e.props.end+1,a=0,o=s,l=null;s<n;s++){var u=i[s],c=i[s+1],h="\\"===u&&"\\"===c,d=s===n-1;"{"===u&&(a+=1),"}"===u&&(a-=1),0===a&&("&"===u||h||d)&&(l=s+(d?1:0),r.push({start:o,end:l}),o=s+1+(h?1:0))}e.props.cells=r}},{key:"findAhead",value:function(e,t){for(var i=this.tex,n=t.length,r=e+n,s=e;s<r;s++)if(i[s]!==t[s-e])return!1;return!0}}]),e}();e.exports=y},function(e,t){"use strict";e.exports={mustFindElement:function(e,t){var i=new Error("You must define a target element.");if(!e)throw i;if("string"==typeof e&&(e=document.querySelector(e),!e))throw i;if(e.tagName.toLowerCase()!==t.toLowerCase())throw new Error("The target element must be <"+t+">.");return e},insertBetween:function(e,t,i){var n=e.slice(0,t),r=e.slice(t);return n+i+r},removeClass:function(e,t){var i=e.className.split(" "),n="",r=!0,s=!1,a=void 0;try{for(var o,l=i[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var u=o.value;u!==t&&(n+=" "+u)}}catch(e){s=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(s)throw a}}e.className=n.trim()},addClass:function(e,t){var i=e.className.split(" ");~i.indexOf(t)||(e.className+=" "+t),e.className=e.className.trim()},toArray:function(e){var t=[].slice;return t.call(e)},inArray:function(e,t){return!!~t.indexOf(e)},repeat:function(e,t){for(var i="",n=e+e,r=t%2!==0,s=Math.floor(t/2),a=0;a<s;a++)i+=n;return r&&(i+=e),i},removeFragment:function(e,t,i){return e.slice(0,t)+e.slice(i)},listToCharacterRegex:function(e){var t=e.map(function(e){return"\\"+e}).join("");return new RegExp("^["+t+"]$")}}},function(e,t){"use strict";e.exports={cursorTex:"{\\cursor}",emptyTex:"\\isEmpty",spacingTex:"\\;",number:/^[0-9]$/,variable:/^[a-zA-Z]$/,nearClosureHaystack:["}","]"],supOrSub:["^","_"],operators:["+","-","=","<",">",",",".",":",";","?","(",")","[","]","|"],escapedOperators:["{","}","%"],escType:{"%":"mi"},charToCommand:{"*":"cdot","/":"div"},relationCommands:["geq","leq","ll","gg","doteq","equiv","approx","cong","simeq","sim","propto","neq","subset","subseteq","nsubseteq","sqsubset","sqsubseteq","preceq","supset","supseteq","nsupseteq","sqsupset","sqsupseteq","succeq"]}},function(e,t,i){"use strict";var n=i(8);e.exports=function(){var e=MathJax.InputJax.TeX,t=MathJax.ElementJax.mml;MathJax.Hub.processSectionDelay=0,MathJax.Hub.Register.StartupHook("TeX Jax Ready",function(){var i={mathvariant:t.INHERIT,mathsize:t.INHERIT,mathbackground:t.INHERIT,mathcolor:t.INHERIT,dir:t.INHERIT};e.Definitions.Add({macros:{cursor:"Cursor",isEmpty:"IsEmpty"}},null,!0),t.mcursor=t.mbase.Subclass({type:"cursor",isToken:!0,isSpacelike:function(){return!0},texClass:t.TEXCLASS.ORD,defaults:i}),t.misEmpty=t.mbase.Subclass({type:"isEmpty",isToken:!0,isSpacelike:function(){return!0},texClass:t.TEXCLASS.ORD,defaults:i}),e.Parse.Augment({Cursor:function(){var e=t.mcursor("0");this.Push(e)},IsEmpty:function(){var e=t.misEmpty("?");this.Push(e)}})}),MathJax.Ajax.Styles(n)}},function(e,t){"use strict";var i="from, to { opacity: 1 }\n 50% { opacity: 0 }";e.exports={".Mathjax_Editor":{"-moz-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none"},".Mathjax_EditorCursor.wasRecentlyPlaced":{animation:"none !important",opacity:"1 !important"},".Mathjax_EditorInput":{left:"-100%",position:"absolute",top:"-100%"},".Mathjax_EditorDisplay":{"box-sizing":"border-box",cursor:"text","overflow-Y":"overflow"},".Mathjax_EditorDisplay *":{outline:"none"},".Mathjax_EditorCursor":{"-webkit-animation":"1s Mathjax_EditorCursorBlink step-end infinite","-moz-animation":"1s Mathjax_EditorCursorBlink step-end infinite","-ms-animation":"1s Mathjax_EditorCursorBlink step-end infinite","-o-animation":"1s Mathjax_EditorCursorBlink step-end infinite",animation:"1s Mathjax_EditorCursorBlink step-end infinite","background-color":"#000",position:"absolute",width:"2px"},".mjx-isEmpty":{color:"#ccc"},"@keyframes Mathjax_EditorCursorBlink":i,"@-moz-keyframes Mathjax_EditorCursorBlink":i,"@-webkit-keyframes Mathjax_EditorCursorBlink":i,"@-ms-keyframes Mathjax_EditorCursorBlink":i,"@-o-keyframes Mathjax_EditorCursorBlink":i}}])});